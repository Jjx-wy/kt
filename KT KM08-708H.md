Affected Versions:

GIGA WIFI Wave 2 - KM08-708H - v1.1

Vulnerability Description:
A vulnerability was discovered in KM08-708H-v1.1, where the function sub_450B2C() in the /usr/sbin/goahead program is susceptible to a buffer overflow. The strcpy function is executed without checking the string length, leading to a buffer overflow.

<img width="403" height="20" alt="image" src="https://github.com/user-attachments/assets/31b25c3e-82d0-4b67-a785-c3721f037db2" />

<img width="711" height="140" alt="image" src="https://github.com/user-attachments/assets/7c1ae980-f41b-4f3b-a8f7-fc8a9c47a399" />

dest is a pointer pointing to v19[v21 + 1], where v21 = 79 * v8, and v19 is a 168-byte array.
Each user record occupies 79 bytes (inferred from v21 = 79 * v8), with v19[0] storing the number of users and v19[1] marking the start of user data.
dest points to v19[79 * v8 + 1], representing the starting position of a username in a user record.
The strcpy function does not check the remaining space in the target buffer. If the length of v4 exceeds the available space in v19, it will cause a buffer overflow.

<img width="339" height="73" alt="image" src="https://github.com/user-attachments/assets/5837cf19-60c4-404f-b5b9-6a704ccb875b" />


<img width="598" height="169" alt="image" src="https://github.com/user-attachments/assets/61b71ba2-4d85-4e86-8477-c5027072aa23" />


<img width="752" height="470" alt="image" src="https://github.com/user-attachments/assets/73ff783d-5130-4659-997a-11c171f0222d" />


Buffer Overflow Result:

<img width="1707" height="894" alt="image" src="https://github.com/user-attachments/assets/47af9ad4-659a-4ab7-8c8b-14c332de3225" />

PoCï¼š

<img width="1011" height="578" alt="image" src="https://github.com/user-attachments/assets/d2e5a8b7-2cf0-4416-9372-40ccedf73354" />
